/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.1.0
 */
import{l as n,m as t,n as e,o as r,f as o,p as u}from"./p-b4c2f2ce.js";
/*!
* focus-trap 7.4.0
* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
*/function i(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function a(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?i(Object(e),!0).forEach((function(t){c(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):i(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}function c(n,t,e){return(t=function(n){var t=function(n,t){if("object"!=typeof n||null===n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var r=e.call(n,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n,"string");return"symbol"==typeof t?t:String(t)}(t))in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var f=function(n){return"Tab"===n.key||9===n.keyCode},s=function(n){return f(n)&&!n.shiftKey},l=function(n){return f(n)&&n.shiftKey},v=function(n){return setTimeout(n,0)},b=function(n,t){var e=-1;return n.every((function(n,r){return!t(n)||(e=r,!1)})),e},d=function(n){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];return"function"==typeof n?n.apply(void 0,e):n},p=function(n){return n.target.shadowRoot&&"function"==typeof n.composedPath?n.composedPath()[0]:n.target},h=[];const w=[];function m(i){const{focusTrapEl:c}=i;c&&(null==c.tabIndex&&(c.tabIndex=-1),i.focusTrap=function(o,u){var i,c=(null==u?void 0:u.document)||document,w=(null==u?void 0:u.trapStack)||h,m=a({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0,isKeyForward:s,isKeyBackward:l},u),y={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,delayInitialFocusTimer:void 0},F=function(n,t,e){return n&&void 0!==n[t]?n[t]:m[e||t]},O=function(n){return y.containerGroups.findIndex((function(t){var e=t.tabbableNodes;return t.container.contains(n)||e.find((function(t){return t===n}))}))},j=function(n){var t=m[n];if("function"==typeof t){for(var e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];t=t.apply(void 0,r)}if(!0===t&&(t=void 0),!t){if(void 0===t||!1===t)return t;throw new Error("`".concat(n,"` was specified but was not a node, or did not return a node"))}var u=t;if("string"==typeof t&&!(u=c.querySelector(t)))throw new Error("`".concat(n,"` as selector refers to no known node"));return u},k=function(){var n=j("initialFocus");if(!1===n)return!1;if(void 0===n)if(O(c.activeElement)>=0)n=c.activeElement;else{var t=y.tabbableGroups[0];n=t&&t.firstTabbableNode||j("fallbackFocus")}if(!n)throw new Error("Your focus-trap needs to have at least one focusable element");return n},D=function(){if(y.containerGroups=y.containers.map((function(r){var o=n(r,m.tabbableOptions),u=t(r,m.tabbableOptions);return{container:r,tabbableNodes:o,focusableNodes:u,firstTabbableNode:o.length>0?o[0]:null,lastTabbableNode:o.length>0?o[o.length-1]:null,nextTabbableNode:function(n){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=u.findIndex((function(t){return t===n}));if(!(r<0))return t?u.slice(r+1).find((function(n){return e(n,m.tabbableOptions)})):u.slice(0,r).reverse().find((function(n){return e(n,m.tabbableOptions)}))}}})),y.tabbableGroups=y.containerGroups.filter((function(n){return n.tabbableNodes.length>0})),y.tabbableGroups.length<=0&&!j("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times")},T=function n(t){!1!==t&&t!==c.activeElement&&(t&&t.focus?(t.focus({preventScroll:!!m.preventScroll}),y.mostRecentlyFocusedNode=t,function(n){return n.tagName&&"input"===n.tagName.toLowerCase()&&"function"==typeof n.select}(t)&&t.select()):n(k()))},E=function(n){var t=j("setReturnFocus",n);return t||!1!==t&&n},g=function(n){var t=p(n);O(t)>=0||(d(m.clickOutsideDeactivates,n)?i.deactivate({returnFocus:m.returnFocusOnDeactivate}):d(m.allowOutsideClick,n)||n.preventDefault())},P=function(n){var t=p(n),e=O(t)>=0;e||t instanceof Document?e&&(y.mostRecentlyFocusedNode=t):(n.stopImmediatePropagation(),T(y.mostRecentlyFocusedNode||k()))},N=function(n){if(("Escape"===(t=n).key||"Esc"===t.key||27===t.keyCode)&&!1!==d(m.escapeDeactivates,n))return n.preventDefault(),void i.deactivate();var t;(m.isKeyForward(n)||m.isKeyBackward(n))&&function(n){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=p(n);D();var u=null;if(y.tabbableGroups.length>0){var i=O(o),a=i>=0?y.containerGroups[i]:void 0;if(i<0)u=t?y.tabbableGroups[y.tabbableGroups.length-1].lastTabbableNode:y.tabbableGroups[0].firstTabbableNode;else if(t){var c=b(y.tabbableGroups,(function(n){return o===n.firstTabbableNode}));c<0&&(a.container===o||r(o,m.tabbableOptions)&&!e(o,m.tabbableOptions)&&!a.nextTabbableNode(o,!1))&&(c=i),c>=0?u=y.tabbableGroups[0===c?y.tabbableGroups.length-1:c-1].lastTabbableNode:f(n)||(u=a.nextTabbableNode(o,!1))}else{var s=b(y.tabbableGroups,(function(n){return o===n.lastTabbableNode}));s<0&&(a.container===o||r(o,m.tabbableOptions)&&!e(o,m.tabbableOptions)&&!a.nextTabbableNode(o))&&(s=i),s>=0?u=y.tabbableGroups[s===y.tabbableGroups.length-1?0:s+1].firstTabbableNode:f(n)||(u=a.nextTabbableNode(o))}}else u=j("fallbackFocus");u&&(f(n)&&n.preventDefault(),T(u))}(n,m.isKeyBackward(n))},A=function(n){var t=p(n);O(t)>=0||d(m.clickOutsideDeactivates,n)||d(m.allowOutsideClick,n)||(n.preventDefault(),n.stopImmediatePropagation())},R=function(){if(y.active)return function(n,t){if(n.length>0){var e=n[n.length-1];e!==t&&e.pause()}var r=n.indexOf(t);-1===r||n.splice(r,1),n.push(t)}(w,i),y.delayInitialFocusTimer=m.delayInitialFocus?v((function(){T(k())})):T(k()),c.addEventListener("focusin",P,!0),c.addEventListener("mousedown",g,{capture:!0,passive:!1}),c.addEventListener("touchstart",g,{capture:!0,passive:!1}),c.addEventListener("click",A,{capture:!0,passive:!1}),c.addEventListener("keydown",N,{capture:!0,passive:!1}),i},S=function(){if(y.active)return c.removeEventListener("focusin",P,!0),c.removeEventListener("mousedown",g,!0),c.removeEventListener("touchstart",g,!0),c.removeEventListener("click",A,!0),c.removeEventListener("keydown",N,!0),i};return(i={get active(){return y.active},get paused(){return y.paused},activate:function(n){if(y.active)return this;var t=F(n,"onActivate"),e=F(n,"onPostActivate"),r=F(n,"checkCanFocusTrap");r||D(),y.active=!0,y.paused=!1,y.nodeFocusedBeforeActivation=c.activeElement,null==t||t();var o=function(){r&&D(),R(),null==e||e()};return r?(r(y.containers.concat()).then(o,o),this):(o(),this)},deactivate:function(n){if(!y.active)return this;var t=a({onDeactivate:m.onDeactivate,onPostDeactivate:m.onPostDeactivate,checkCanReturnFocus:m.checkCanReturnFocus},n);clearTimeout(y.delayInitialFocusTimer),y.delayInitialFocusTimer=void 0,S(),y.active=!1,y.paused=!1,function(n,t){var e=n.indexOf(t);-1!==e&&n.splice(e,1),n.length>0&&n[n.length-1].unpause()}(w,i);var e=F(t,"onDeactivate"),r=F(t,"onPostDeactivate"),o=F(t,"checkCanReturnFocus"),u=F(t,"returnFocus","returnFocusOnDeactivate");null==e||e();var c=function(){v((function(){u&&T(E(y.nodeFocusedBeforeActivation)),null==r||r()}))};return u&&o?(o(E(y.nodeFocusedBeforeActivation)).then(c,c),this):(c(),this)},pause:function(n){if(y.paused||!y.active)return this;var t=F(n,"onPause"),e=F(n,"onPostPause");return y.paused=!0,null==t||t(),S(),null==e||e(),this},unpause:function(n){if(!y.paused||!y.active)return this;var t=F(n,"onUnpause"),e=F(n,"onPostUnpause");return y.paused=!1,null==t||t(),D(),R(),null==e||e(),this},updateContainerElements:function(n){var t=[].concat(n).filter(Boolean);return y.containers=t.map((function(n){return"string"==typeof n?c.querySelector(n):n})),y.active&&D(),this}}).updateContainerElements(o),i}(c,{clickOutsideDeactivates:!0,document:c.ownerDocument,escapeDeactivates:!1,fallbackFocus:c,setReturnFocus:n=>(o(n),!1),tabbableOptions:u,trapStack:w}))}function y(n){n.focusTrapDisabled||n.focusTrap?.activate()}function F(n){n.focusTrap?.deactivate()}function O(n){n.focusTrap?.updateContainerElements(n.focusTrapEl)}export{y as a,m as c,F as d,O as u}